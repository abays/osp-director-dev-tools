{% if osp.tlse|default(false)|bool %}
parameter_defaults:
  EnableInternalTLS: True
  NotifyUseSSL: True
  RpcUseSSL: True
  ServerMetadata:
    ipa_enroll: True
  IdMServer: freeipa.{{ base_domain_name }}
  IdMDomain: {{ osp.domain_name }}
  IdMInstallClientPackages: true
  PublicSSLCertificateAutogenerated: true

resource_registry:

  OS::TripleO::Services::HAProxyPublicTLS: deployment/haproxy/haproxy-public-tls-certmonger.yaml
  OS::TripleO::Services::HAProxyInternalTLS: deployment/haproxy/haproxy-internal-tls-certmonger.yaml
  OS::TripleO::Services::IpaClient: deployment/ipa/ipaservices-baremetal-ansible.yaml
  OS::TripleO::Services::TLSProxyBase: deployment/apache/apache-baremetal-puppet.yaml
  OS::TripleO::ControllerServiceServerMetadataHook: extraconfig/nova_metadata/krb-service-principals/controller-role.yaml
  OS::TripleO::Compute{% if "hci" in osp.extrafeatures %}HCI{% endif %}ServiceServerMetadataHook: extraconfig/nova_metadata/krb-service-principals/compute{% if "hci" in osp.extrafeatures %}hci{% endif %}-role.yaml

{% else %}
parameter_defaults:
  EnableInternalTLS: False
{% endif %}